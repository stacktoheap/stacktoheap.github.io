<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}</title>
  <meta name="description" content="{% if page.excerpt %}{{ page.excerpt | strip_html | strip_newlines | truncate: 160 }}{% else %}{{ site.description }}{% endif %}">
  {%if page.tags %}
  <meta name="keywords" content="{{ page.tags | join: ', ' | escape }}"/>
  {%endif %}
  {% include open_graph.html %}
  {% include twitter_card.html %}
  <meta name="theme-color" content="#641AE6">
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
  <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
  <link rel="stylesheet" href="{{ "/assets/css/main.css" | relative_url }}">
  <link rel="preload" href="{{ "/assets/css/syntax.css" | prepend: site.baseurl }}" as="style" onload="this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="{{ "/assets/css/syntax.css" | prepend: site.baseurl }}"></noscript>
  <link rel="canonical" href="{{ page.url | replace:'index.html','' | prepend: site.baseurl | prepend: site.url }}">
  <link rel="alternate" type="application/rss+xml" title="{{ site.title }}" href="{{ "/feed.xml" | prepend: site.baseurl | prepend: site.url }}">
  <link rel="manifest" href="/manifest.json">
  
  <!-- Theme switching script -->
  <script>
    // Check for saved theme preference or use system preference
    function getTheme() {
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme) {
        return savedTheme;
      }
      
      // Use system preference if no saved theme
      return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    }
    
    const currentTheme = getTheme();
    document.documentElement.setAttribute('data-theme', currentTheme);
    
    // Set the theme controller checkbox state
    document.addEventListener('DOMContentLoaded', function() {
      const themeController = document.querySelector('.theme-controller');
      if (themeController) {
        themeController.checked = currentTheme === 'dark';
        
        themeController.addEventListener('change', function() {
          const newTheme = this.checked ? 'dark' : 'light';
          document.documentElement.setAttribute('data-theme', newTheme);
          localStorage.setItem('theme', newTheme);
        });
      }
      
      // Listen for system theme changes (when user hasn't manually set a preference)
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
        if (!localStorage.getItem('theme')) {
          const systemTheme = e.matches ? 'dark' : 'light';
          document.documentElement.setAttribute('data-theme', systemTheme);
          if (themeController) {
            themeController.checked = systemTheme === 'dark';
          }
        }
      });
    });
  </script>
  
  {% include google_analytics.html %}
</head>
