<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Things that trip newbies in Powershell</title>
  <meta name="description" content="Some common things that trip up new Powershell users.">
  
  <meta name="keywords" content=""/>
  
  <meta content="StackToHeap" property="og:site_name">

  <meta content="Things that trip newbies in Powershell" property="og:title">


  <meta content="article" property="og:type">


  <meta content="Some common things that trip up new Powershell users." property="og:description">


  <meta content="https://stacktoheap.com/blog/2012/12/16/things-that-trip-newbies-in-powershell/" property="og:url">


  <meta content="2012-12-16T22:44:00+00:00" property="article:published_time">
  <meta content="https://stacktoheap.com/about/" property="article:author">


  <meta content="https://stacktoheap.com/images/logo-high-resolution.png" property="og:image">


  
  <meta content="powershell" property="article:section">
  


  


  <meta name="twitter:site" value="@manojlds">
<meta name="twitter:creator" value="@manojlds">
<meta name="twitter:card" value="summary_large_image">

<meta name="twitter:image" content="https://stacktoheap.com/images/logo-high-resolution.png">



  <meta name="theme-color" content="#641AE6">
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
  <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="preload" href="/assets/css/syntax.css" as="style" onload="this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/assets/css/syntax.css"></noscript>
  <link rel="canonical" href="https://stacktoheap.com/blog/2012/12/16/things-that-trip-newbies-in-powershell/">
  <link rel="alternate" type="application/rss+xml" title="StackToHeap" href="https://stacktoheap.com/feed.xml">
  <link rel="manifest" href="/manifest.json">
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-35693303-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>


  <body class="font-sans m-0">

    <div class="navbar bg-primary text-primary-content">
  <div class="flex-1">
    <a class="btn btn-ghost normal-case text-xl" href="/" >
      StackToHeap
    </a>
  </div>
  <div class="flex-none">
    <ul class="menu menu-horizontal px-1">
      
        
        <li><a href="/about/">About</a></li>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
      <li><a href="/feed.xml">RSS</a></li>
    </ul>
  </div>
</div>

    <div class="container mt-12 p-4">
        <article class="prose lg:prose-xl lg:leading-normal" itemscope itemtype="http://schema.org/BlogPosting">
  <h1 itemprop="name headline">Things that trip newbies in Powershell</h1>
  <p class="post-meta"><time datetime="2012-12-16T22:44:00+00:00" itemprop="datePublished">Dec 16, 2012</time></p>
  <div class="post-content" itemprop="articleBody">
    <p>Powershell is amazing. It really lives upto its name. But many a times, I have found new comers tripping on a few Powershell oddities. Here I higlight my favorite three.</p>

<p>First and foremost, something that confuses most anyone who starts using Powershell is what version of Powershell that they are using. Micorosft, in its usual ways, install Powershell, upto the latest 3.0 version, at the <code class="language-plaintext highlighter-rouge">C:\Windows\System32\WindowsPowerShell\v1.0</code> ( you can get it by doing <code class="language-plaintext highlighter-rouge">$pshome</code> from a Powershell console.) Notice the <code class="language-plaintext highlighter-rouge">v1.0</code> at the end. Seeing that, it obviously raises confusion as most resource on Powershell is for v2.0 ( at the time of this writing, eventhough v3.0 is out.) ad people want to be on v2.0 and not v1.0. The easiest way to identify the Powershell version is to just run <code class="language-plaintext highlighter-rouge">get-host</code> in Powershell. Or to be more specific <code class="language-plaintext highlighter-rouge">(get-host).Version</code>.</p>

<p>Another thing that causes even more confusion is the way to pass arguments to functions.</p>

<p>Say there is a function as defined below:</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="kr">function</span><span class="w"> </span><span class="nf">Name</span><span class="p">(</span><span class="nv">$firstName</span><span class="p">,</span><span class="w"> </span><span class="nv">$lastName</span><span class="p">){</span><span class="w">
    </span><span class="n">write-host</span><span class="w"> </span><span class="s2">"First name: </span><span class="nv">$firstName</span><span class="s2">"</span><span class="w">
    </span><span class="n">write-host</span><span class="w"> </span><span class="s2">"Last name: </span><span class="nv">$lastName</span><span class="s2">"</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p>If we call the function <code class="language-plaintext highlighter-rouge">Name John, Smith</code>, the expected output would be something like:</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">First</span><span class="w"> </span><span class="nx">name:</span><span class="w"> </span><span class="nx">John</span><span class="w">
</span><span class="n">Last</span><span class="w"> </span><span class="nx">name:</span><span class="w"> </span><span class="nx">Smith</span></code></pre></figure>

<p>But what would be seen is:</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="n">First</span><span class="w"> </span><span class="nx">name:</span><span class="w"> </span><span class="nx">John</span><span class="w"> </span><span class="nx">Smith</span><span class="w">
</span><span class="n">Last</span><span class="w"> </span><span class="nx">name:</span></code></pre></figure>

<p>I have seen many do this mistake. Arguments in Powershell, to Powershell functions are separated by space. When you comma delimit them, you are actually passing an array of those values. In this case, the array with two values <code class="language-plaintext highlighter-rouge">("John", "Smith"), was given to the parameter </code>$firstName` and hence the output you see.</p>

<p>I mention Powershell functions above because method calls on .NET objects still use comma to delimit arguments:</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="p">[</span><span class="n">string</span><span class="p">]::</span><span class="n">format</span><span class="p">(</span><span class="s2">"{0},{1}"</span><span class="p">,</span><span class="w"> </span><span class="s2">"comma"</span><span class="p">,</span><span class="w"> </span><span class="s2">"delimited"</span><span class="p">)</span></code></pre></figure>

<p>Lastly, I see newcomers get trumped by <code class="language-plaintext highlighter-rouge">Select-Object</code>. As known, Select-Object selects particular properties from objects and sends them to the pipeline.</p>

<p>For example,</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="nv">$names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get-childitem</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">select-object</span><span class="w"> </span><span class="nx">Name</span></code></pre></figure>

<p>would put the names of directories and files in the current directory in <code class="language-plaintext highlighter-rouge">$names</code></p>

<p>It is logical to thing that <code class="language-plaintext highlighter-rouge">$names</code> is a collection of strings. But it is not! It is a collection of objects with a single property (in this case) <code class="language-plaintext highlighter-rouge">Name</code>. To access the actual name, you do <code class="language-plaintext highlighter-rouge">$names[0].Name</code>.</p>

<p>If you wanted only the collection of string in the first place, you use the <code class="language-plaintext highlighter-rouge">-ExpandProperty</code> parameter (<code class="language-plaintext highlighter-rouge">-expand</code> in short) of <code class="language-plaintext highlighter-rouge">Select-Object</code>:</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="nv">$names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get-childitem</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">select-object</span><span class="w"> </span><span class="nt">-expand</span><span class="w"> </span><span class="nx">Name</span></code></pre></figure>

<p>Now, <code class="language-plaintext highlighter-rouge">$names</code> is just a collection of vanilla strings.</p>


  </div>
  
    <div class="divider">Comments</div>
    <section>
      <div id="disqus_thread" aria-live="polite">
<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
      this.page.url = 'https://stacktoheap.com/blog/2012/12/16/things-that-trip-newbies-in-powershell/';
      this.page.identifier = 'https://stacktoheap.com/blog/2012/12/16/things-that-trip-newbies-in-powershell/';
    };
    
    (function() {
    var d = document, s = d.createElement('script');
    s.src = 'https://stacktoheap.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
    </section>
  
</article>

    </div>

    <footer class="footer footer-center p-10 bg-base-200 text-base-content rounded">
  <div class="grid grid-flow-col gap-4">
  </div> 
  <div>
    <div class="grid grid-flow-col gap-4">
      <a href="https://github.com/manojlds"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill-current"><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path></svg></a> 
      <a href="https://github.com/manojlds"><svg width="20" height="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="inline-block h-5 w-5 fill-current md:h-6 md:w-6"><path d="M256,32C132.3,32,32,134.9,32,261.7c0,101.5,64.2,187.5,153.2,217.9a17.56,17.56,0,0,0,3.8.4c8.3,0,11.5-6.1,11.5-11.4,0-5.5-.2-19.9-.3-39.1a102.4,102.4,0,0,1-22.6,2.7c-43.1,0-52.9-33.5-52.9-33.5-10.2-26.5-24.9-33.6-24.9-33.6-19.5-13.7-.1-14.1,1.4-14.1h.1c22.5,2,34.3,23.8,34.3,23.8,11.2,19.6,26.2,25.1,39.6,25.1a63,63,0,0,0,25.6-6c2-14.8,7.8-24.9,14.2-30.7-49.7-5.8-102-25.5-102-113.5,0-25.1,8.7-45.6,23-61.6-2.3-5.8-10-29.2,2.2-60.8a18.64,18.64,0,0,1,5-.5c8.1,0,26.4,3.1,56.6,24.1a208.21,208.21,0,0,1,112.2,0c30.2-21,48.5-24.1,56.6-24.1a18.64,18.64,0,0,1,5,.5c12.2,31.6,4.5,55,2.2,60.8,14.3,16.1,23,36.6,23,61.6,0,88.2-52.4,107.6-102.3,113.3,8,7.1,15.2,21.1,15.2,42.5,0,30.7-.3,55.5-.3,63,0,5.4,3.1,11.5,11.4,11.5a19.35,19.35,0,0,0,4-.4C415.9,449.2,480,363.1,480,261.7,480,134.9,379.7,32,256,32Z"></path></svg></a> 
    </div>
  </div> 
  <div>
    <p>Copyright © 2023 - StackToHeap</p>
  </div>
</footer>

    <script type="text/javascript">
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/sw.js').then(function(registration) {
      console.log('ServiceWorker registration successful with scope: ', registration.scope);
    }, function(err) {
      console.log('ServiceWorker registration failed: ', err);
    });
  });
}
</script>

  </body>

</html>
