<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Sharing docker images without a registry</title>
  <meta name="description" content="Sharing docker images between developer workstations without a registry">
  
  <meta name="keywords" content="docker, docker-machine, docker-sync, registry, docker-save, docker-load"/>
  
  <meta content="StackToHeap" property="og:site_name">

  <meta content="Sharing docker images without a registry" property="og:title">


  <meta content="article" property="og:type">


  <meta content="Sharing docker images between developer workstations without a registry" property="og:description">


  <meta content="https://stacktoheap.com/blog/2015/11/22/sharing-docker-images-without-registry/" property="og:url">


  <meta content="2015-11-22T23:30:00+00:00" property="article:published_time">
  <meta content="https://stacktoheap.com/about/" property="article:author">


  <meta content="https://stacktoheap.com/images/logo-high-resolution.png" property="og:image">


  
  <meta content="docker" property="article:section">
  


  
  <meta content="docker" property="article:tag">
  
  <meta content="docker-machine" property="article:tag">
  
  <meta content="docker-sync" property="article:tag">
  
  <meta content="registry" property="article:tag">
  
  <meta content="docker-save" property="article:tag">
  
  <meta content="docker-load" property="article:tag">
  


  <meta name="twitter:site" value="@manojlds">
<meta name="twitter:creator" value="@manojlds">
<meta name="twitter:card" value="summary_large_image">

<meta name="twitter:image" content="https://stacktoheap.com/images/logo-high-resolution.png">


  <meta name="twitter:label1" value="Reading time">
  <meta name="twitter:data1" value="5 mins üïë">


  <meta name="theme-color" content="#641AE6">
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
  <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="preload" href="/assets/css/syntax.css" as="style" onload="this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/assets/css/syntax.css"></noscript>
  <link rel="canonical" href="https://stacktoheap.com/blog/2015/11/22/sharing-docker-images-without-registry/">
  <link rel="alternate" type="application/rss+xml" title="StackToHeap" href="https://stacktoheap.com/feed.xml">
  <link rel="manifest" href="/manifest.json">
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-35693303-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>


  <body class="font-sans m-0">

    <div class="navbar bg-primary text-primary-content">
  <div class="flex-1">
    <a class="btn btn-ghost normal-case text-xl" href="/" >
      StackToHeap
    </a>
  </div>
  <div class="flex-none">
    <ul class="menu menu-horizontal px-1">
      
        
        <li><a href="/about/">About</a></li>
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
      <li><a href="/feed.xml">RSS</a></li>
    </ul>
  </div>
</div>

    <div class="container mt-12 p-4">
        <article class="prose lg:prose-xl lg:leading-normal" itemscope itemtype="http://schema.org/BlogPosting">
  <h1 itemprop="name headline">Sharing docker images without a registry</h1>
  <p class="post-meta"><time datetime="2015-11-22T23:30:00+00:00" itemprop="datePublished">Nov 22, 2015</time></p>
  <div class="post-content" itemprop="articleBody">
    <p>One of the well-known ways of sharing docker images is via a registry - be it the hosted ones like <a href="https://hub.docker.com/">DockerHub</a> or <a href="https://quay.io/">Quay.io</a>, or private registries setup within your organization.</p>

<p>Also, once a workstation has a set of images, pulling in new versions or similar images becomes a breeze.</p>

<p>But we wanted to share images between developer workstations, without having to push and pull from a registry.</p>

<h3 id="why-no-registry">Why no registry?</h3>

<p>Recently, when we were switching to a docker based workflow, we found that pulling in the base set of images from our internal registry on AWS + S3 was taking a lot of time. Not to mention that it was also eating up our bandwidth. In order to make it easy and fast for new developers to get started with our project, we wanted to setup a local ‚Äústore‚Äù of images that we can pull our images from. This store will also help us share new images quicker as well.</p>

<p>Instead of setting up a local registry in our office LAN, we decided to keep things simple and setup a simple workstation to pull in images via SSH. The <code class="language-plaintext highlighter-rouge">docker save</code> and <code class="language-plaintext highlighter-rouge">docker load</code> commands helped us beautifully here. We also piped from/to these command directly to/from the workstation, and avoided local files altogether.</p>

<h3 id="docker-save-and-docker-load">docker save and docker load</h3>

<p>First, some basics about <code class="language-plaintext highlighter-rouge">docker save</code> and <code class="language-plaintext highlighter-rouge">docker load</code>:</p>

<p><code class="language-plaintext highlighter-rouge">docker save</code> allows use to save a image to a tar archive. It streams to STDOUT by default, or to a file specified by the <code class="language-plaintext highlighter-rouge">-o, --output</code> flag.</p>

<p><code class="language-plaintext highlighter-rouge">docker load</code> sits in the other end, and takes in input from a file, specified by the <code class="language-plaintext highlighter-rouge">-i, --input</code> flag or STDIN.</p>

<h3 id="sync-tofrom-external-host-via-ssh">Sync to/from external host via ssh</h3>

<p>Once we had the workstation in our LAN (let‚Äôs say its IP is 192.168.0.42), syncing an image to it is as simple as:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">docker save internal-registry/image | bzip2 | <span class="se">\</span>
  pv | ssh 192.168.0.42 <span class="s2">"cat &gt; ~/docker_images/image"</span></code></pre></figure>

<p>(this push can be done from a one workstation where the image was built, or pulled in from a registry)</p>

<p>We used <code class="language-plaintext highlighter-rouge">bzip2</code> to compress the data, and the amazing <code class="language-plaintext highlighter-rouge">pv</code> tool to visualize the transfer.</p>

<p>Pulling in an image is not much different:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">ssh 192.168.0.42 <span class="s2">"cat ~/docker_images/image"</span> | pv | <span class="se">\</span>
  bunzip2 | docker load</code></pre></figure>

<h3 id="sync-between-multiple-docker-machines">Sync between multiple docker machines</h3>

<p>We use <a href="https://docs.docker.com/machine/">docker-machine</a> on OS X for development. This strategy can also be used to share or backup images between different docker-machines. If there are two machines, say <code class="language-plaintext highlighter-rouge">dev1</code> and <code class="language-plaintext highlighter-rouge">dev2</code> running, we can sync an image between the two like below:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">docker <span class="si">$(</span>docker-machine config dev1<span class="si">)</span> save image | <span class="se">\</span>
  docker <span class="si">$(</span>docker-machine config dev2<span class="si">)</span> load</code></pre></figure>

<p>If a machine (say <code class="language-plaintext highlighter-rouge">dev</code>) is going to be recreated, we can save the image(s) and reload:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">docker <span class="si">$(</span>docker-machine config dev<span class="si">)</span> save <span class="nt">-o</span> image.tar image
docker-machine <span class="nb">rm </span>dev
docker-machine create <span class="nt">--provider</span> virtualbox dev
docker <span class="si">$(</span>docker-machine config dev<span class="si">)</span> load <span class="nt">-i</span> image.tar</code></pre></figure>

<p>This should make using multiple docker-machines or recreating existing ones less of an hassle in terms of getting the base set of images.</p>

<p>This simple setup makes pulling in images much faster, and also saves bandwidth. Hope it is useful in your work environment too.</p>

  </div>
  
    <div class="divider">Comments</div>
    <section>
      <div id="disqus_thread" aria-live="polite">
<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
      this.page.url = 'https://stacktoheap.com/blog/2015/11/22/sharing-docker-images-without-registry/';
      this.page.identifier = 'https://stacktoheap.com/blog/2015/11/22/sharing-docker-images-without-registry/';
    };
    
    (function() {
    var d = document, s = d.createElement('script');
    s.src = 'https://stacktoheap.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
    </section>
  
</article>

    </div>

    <footer class="footer footer-center p-10 bg-base-200 text-base-content rounded">
  <div class="grid grid-flow-col gap-4">
  </div> 
  <div>
    <div class="grid grid-flow-col gap-4">
      <a href="https://github.com/manojlds"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill-current"><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path></svg></a> 
      <a href="https://github.com/manojlds"><svg width="20" height="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="inline-block h-5 w-5 fill-current md:h-6 md:w-6"><path d="M256,32C132.3,32,32,134.9,32,261.7c0,101.5,64.2,187.5,153.2,217.9a17.56,17.56,0,0,0,3.8.4c8.3,0,11.5-6.1,11.5-11.4,0-5.5-.2-19.9-.3-39.1a102.4,102.4,0,0,1-22.6,2.7c-43.1,0-52.9-33.5-52.9-33.5-10.2-26.5-24.9-33.6-24.9-33.6-19.5-13.7-.1-14.1,1.4-14.1h.1c22.5,2,34.3,23.8,34.3,23.8,11.2,19.6,26.2,25.1,39.6,25.1a63,63,0,0,0,25.6-6c2-14.8,7.8-24.9,14.2-30.7-49.7-5.8-102-25.5-102-113.5,0-25.1,8.7-45.6,23-61.6-2.3-5.8-10-29.2,2.2-60.8a18.64,18.64,0,0,1,5-.5c8.1,0,26.4,3.1,56.6,24.1a208.21,208.21,0,0,1,112.2,0c30.2-21,48.5-24.1,56.6-24.1a18.64,18.64,0,0,1,5,.5c12.2,31.6,4.5,55,2.2,60.8,14.3,16.1,23,36.6,23,61.6,0,88.2-52.4,107.6-102.3,113.3,8,7.1,15.2,21.1,15.2,42.5,0,30.7-.3,55.5-.3,63,0,5.4,3.1,11.5,11.4,11.5a19.35,19.35,0,0,0,4-.4C415.9,449.2,480,363.1,480,261.7,480,134.9,379.7,32,256,32Z"></path></svg></a> 
    </div>
  </div> 
  <div>
    <p>Copyright ¬© 2023 - StackToHeap</p>
  </div>
</footer>

    <script type="text/javascript">
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/sw.js').then(function(registration) {
      console.log('ServiceWorker registration successful with scope: ', registration.scope);
    }, function(err) {
      console.log('ServiceWorker registration failed: ', err);
    });
  });
}
</script>

  </body>

</html>
